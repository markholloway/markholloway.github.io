<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    <title>Remote Windows management with PsTools, part 2 | Mark Holloway</title>
    <meta name="description" content="Notes from a curiosity-driven engineer.">
    <link rel="canonical" href="http://localhost:1313/blog/2011/05/15/remote-windows-management-with-pstools-part-2/">
    
    
    <meta property="og:url" content="http://localhost:1313/blog/2011/05/15/remote-windows-management-with-pstools-part-2/">
  <meta property="og:site_name" content="Mark Holloway">
  <meta property="og:title" content="Remote Windows management with PsTools, part 2">
  <meta property="og:description" content="In this second part of managing Windows machines using the PsTools suite, we will look at how to automate processes involving interacting with a server.
Examples of task scripts for installing Nuke, Maya and V-Ray can be found further down in this article. A zip package is available here with all scripts explained in this article.
The concept This is the main concept; from a local managing machine (such as a laptop), have workstations and farm machines run a remote script to carry out a task. Have a look at the diagram below:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2011-05-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2011-05-15T00:00:00+00:00">
    <meta property="article:tag" content="Pstools">
    <meta property="article:tag" content="Windows">

    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Remote Windows management with PsTools, part 2">
  <meta name="twitter:description" content="In this second part of managing Windows machines using the PsTools suite, we will look at how to automate processes involving interacting with a server.
Examples of task scripts for installing Nuke, Maya and V-Ray can be found further down in this article. A zip package is available here with all scripts explained in this article.
The concept This is the main concept; from a local managing machine (such as a laptop), have workstations and farm machines run a remote script to carry out a task. Have a look at the diagram below:">

    
    
    
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Remote Windows management with PsTools, part 2",
  "datePublished": "2011-05-15T00:00:00Z",
  "dateModified": "2011-05-15T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http:\/\/localhost:1313\/blog\/2011\/05\/15\/remote-windows-management-with-pstools-part-2\/"
  },
  "author": {
    "@type": "Person",
    "name": "map[]"
  },
  "description": "In this second part of managing Windows machines using the PsTools suite, we will look at how to automate processes involving interacting with a server.\nExamples of task scripts for installing Nuke, Maya and V-Ray can be found further down in this article. A zip package is available here with all scripts explained in this article.\nThe concept This is the main concept; from a local managing machine (such as a laptop), have workstations and farm machines run a remote script to carry out a task. Have a look at the diagram below:\n"
}
</script>



    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    
    
    <link rel="preload" href="/fonts/BerkeleyMono-Variable.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="/fonts/CommitMono-Variable.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="/fonts/MapleMono-Italic.woff2" as="font" type="font/woff2" crossorigin>
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/github-link.css" />
    
    <script defer src="https://cloud.umami.is/script.js" data-website-id="c9c97df3-bc05-4b29-8caa-fcf03a05710f"></script>

  </head>

  <body class="preload">
    <script>
      (function() {
        
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
          document.body.classList.add(savedTheme);
        } else {
          if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.body.classList.add('dark');
          }
        }
        
        
        if ('fonts' in document) {
          
          Promise.race([
            document.fonts.ready,
            new Promise(resolve => setTimeout(resolve, 100)) 
          ]).then(() => {
            document.body.classList.remove('preload');
          });
        } else {
          
          setTimeout(() => {
            document.body.classList.remove('preload');
          }, 50);
        }
      })();
    </script>

    <nav style="display: flex; align-items: center; gap: 1em; flex-wrap: wrap;">
      <ul class="menu" style="margin: 0; padding: 0; flex-shrink: 0;">
        
        
        <li><a  href="/">Home</a></li>
        
        <li><a  href="/blog/">Blog</a></li>
        
        <li><a  href="/about/">About</a></li>
        
        <li><button id="theme-toggle" style="background:none; border:none; cursor:pointer; font-size:1em; padding:5px; color:inherit;">◑</button></li>
      </ul>
      
      
      <div id="search" style="flex-grow: 1; min-width: 200px;"></div>
    </nav>
    
    <link href="/pagefind/pagefind-ui.css" rel="stylesheet">
    <script src="/pagefind/pagefind-ui.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            new PagefindUI({ 
              element: "#search", 
              showSubResults: true,
              showImages: false,
              translations: {
                placeholder: "Search...",
                clear_search: "×"
              }
            });

            
            document.addEventListener('click', (e) => {
                const searchContainer = document.querySelector('#search');
                if (searchContainer && !searchContainer.contains(e.target)) {
                    const clearButton = searchContainer.querySelector('.pagefind-ui__search-clear');
                    if (clearButton) {
                        clearButton.click();
                    }
                }
            });

            
            const toggle = document.getElementById('theme-toggle');
            const body = document.body;

            toggle.addEventListener('click', () => {
              if (body.classList.contains('dark')) {
                body.classList.remove('dark');
                body.classList.add('light');
                localStorage.setItem('theme', 'light');
              } else {
                body.classList.remove('light');
                body.classList.add('dark');
                localStorage.setItem('theme', 'dark');
              }
            });
        });
    </script>


<div class="article-meta">
<h1><span class="title">Remote Windows management with PsTools, part 2</span></h1>

<div class="article-meta-info">
  <span class="date">2011-05-15</span>
  
  <span class="article-tags">
    
    
    
    <a href="/tags/pstools">#pstools</a>
    
    
    
    <a href="/tags/windows">#windows</a>
    
    
  </span>
  
</div>
</div>



<main data-pagefind-body>
	
	
		
		<aside class="table-of-contents">
			<div class="toc-title">
				<svg class="callout-icon" viewBox="0 0 24 24" width="16" height="16" aria-hidden="true"
					fill="currentColor">
					<path
						d="M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z">
					</path>
				</svg>
				Table of Contents
			</div>
			<nav id="TableOfContents">
  <ul>
    <li><a href="#the-concept">The concept</a></li>
    <li><a href="#the-bat-launcher-script">The .bat launcher script</a></li>
    <li><a href="#step-1-installing-the-bat-launcher-script-throughout-the-remote-machines">Step 1: Installing the .bat launcher script throughout the remote machines</a></li>
    <li><a href="#step-2-the-main-distribution-script">Step 2: The main distribution script</a></li>
    <li><a href="#step-3-creating-and-launching-a-task-script">Step 3: Creating and launching a task script</a></li>
    <li><a href="#step-4-solving-problems">Step 4: Solving problems</a></li>
    <li><a href="#a-collection-of-task-scripts">A collection of task scripts</a>
      <ul>
        <li><a href="#nuke-62v4">Nuke 6.2v4</a></li>
        <li><a href="#setting-an-environment-variable">Setting an environment variable</a></li>
        <li><a href="#python-31">Python 3.1</a></li>
        <li><a href="#maya-2012">Maya 2012</a></li>
        <li><a href="#v-ray-150-nightly-build-for-maya-2011">V-Ray 1.50 nightly build for Maya 2011</a></li>
      </ul>
    </li>
  </ul>
</nav>
		</aside>
		

		<p>In this second part of managing Windows machines using the PsTools suite, we will look at how to automate processes involving interacting with a server.</p>
<p>Examples of task scripts for installing Nuke, Maya and V-Ray can be found further down in this article. A zip package is available here with all scripts explained in this article.</p>
<h2 id="the-concept">The concept</h2>
<p>This is the main concept; from a local managing machine (such as a laptop), have workstations and farm machines run a remote script to carry out a task. Have a look at the diagram below:</p>
<p><img src="/blog/assets/pstools/ps01_pstools_illustration.png" alt=""></p>
<h2 id="the-bat-launcher-script">The .bat launcher script</h2>
<p>When any of the tools in the PsTools suite are used to connect to a remote machine, it opens up a command line session which does not automatically have drive letters mapped to server shares. Because of this, in order to gain access to .bat task scripts on the server from within that session, we will need something I call a .bat launcher script, which will map the server share to a drive letter.</p>
<p>This .bat launcher will have to reside on each remote machine and has to be put there manually.</p>
<h2 id="step-1-installing-the-bat-launcher-script-throughout-the-remote-machines">Step 1: Installing the .bat launcher script throughout the remote machines</h2>
<p>In the example below, my server is called <code>10.0.1.200</code>. It has a share called job which serves as a base for where I am going to put all my automation/task bat scripts later on. In order to gain read and write access to this server, I am using the username <code>roger</code> with password <code>rabbit</code>. Also, in all my examples and code, I have extracted the PsTools suite of tools into the server’s <code>include\psTools\</code> path, so I suggest you do the same!</p>
<p>Start by copying the following BAT file into <code>c:\deploy</code> on your Windows based machines you wish to manage remotely, and name it <code>batlauncher.bat</code>:</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="p">@</span><span class="k">cls</span>
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> Remote BAT Launcher
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> -----------------------------------------
</span></span><span class="line"><span class="cl">net use j: \\10.0.1.200\job /User:roger rabbit
</span></span><span class="line"><span class="cl">net use
</span></span><span class="line"><span class="cl">j<span class="p">:</span><span class="nl">\include\psTools\scripts\%1</span></span></span></code></pre></div></div>
<p>Explanation of the code: the <code>net</code> command mounts the share job onto the drive letter j and presents whether this was successful or not onto the screen. Then it tries to launch a bat file stored on this share, in the sub folder <code>j:\include\psTools\scripts\</code>. The <code>%1</code> is a variable, which will later be replaced with a bat file name.</p>
<p>So let us have a look at that diagram again&hellip;</p>
<p><img src="/blog/assets/pstools/ps02_pstools_illustration_step1.png" alt=""></p>
<p>The .bat launcher script has been placed on our Windows based machines we wish to remotely manage and we also have PsTools placed on the server. Great!</p>
<h2 id="step-2-the-main-distribution-script">Step 2: The main distribution script</h2>
<p>From my local managing machine, I will now create a bat file with the following contents and then call it <code>manage_farm.bat</code>:</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="p">@</span><span class="k">cls</span>
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> You are about to run the remote machine&#39;s local batlauncher.bat and tell it to execute <span class="nv">%1</span> on all remote machines.
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> Is this really what you want?
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> Hit ctrl+c to cancel.
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">pause</span>
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Running batch <span class="nv">%1</span> <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%0</span>.log
</span></span><span class="line"><span class="cl">j<span class="p">:</span><span class="nl">\include\psTools\PsExec.exe</span><span class="c1"> @hosts.txt -u roger -p -d rabbit c:\deploy\batlauncher.bat %1 &gt;&gt; j:\include\psTools\logs\%0.log</span>
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Batch for <span class="nv">%1</span> completed <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%0</span>.log
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> ----------------
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> BATCH COMPLETED!
</span></span><span class="line"><span class="cl"><span class="p">@</span>pause</span></span></code></pre></div></div>
<p>Then create the <code>hosts.txt</code> file, listing all the remote machines:</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">100.10.0.101
</span></span><span class="line"><span class="cl">100.10.0.102
</span></span><span class="line"><span class="cl">100.10.0.103
</span></span><span class="line"><span class="cl">100.10.0.104
</span></span><span class="line"><span class="cl">100.10.0.105
</span></span><span class="line"><span class="cl">100.10.0.106
</span></span><span class="line"><span class="cl">100.10.0.107
</span></span><span class="line"><span class="cl">100.10.0.108
</span></span><span class="line"><span class="cl">100.10.0.109
</span></span><span class="line"><span class="cl">100.10.0.110
</span></span><span class="line"><span class="cl">100.10.0.111
</span></span><span class="line"><span class="cl">100.10.0.112</span></span></code></pre></div></div>
<p>Replace IP-addresses, usernames and passwords so that it fits your setup.</p>
<p>Let us place these two files in the same folder on the server, so that the manage_farm.bat script can be launched from any machine. I like this path: <code>j:\include\psTools\distros</code> for this example. Make sure you create the logs folder at <code>j:\include\psTools\logs\</code> or you will receive errors that the log files cannot be written.</p>
<p>This is where we are at now:</p>
<p><img src="/blog/assets/pstools/ps3_pstools_illustration_step2.png" alt=""></p>
<p>Okay, so now we have set up both the share mounting script as well as the distribution script. Next up, a bat file to carry out an actual task.</p>
<h2 id="step-3-creating-and-launching-a-task-script">Step 3: Creating and launching a task script</h2>
<p>For now, let us just perform a &ldquo;hello world&rdquo; on each remote machine, which will be piped to a log file, so that we can see if this chain of bat file actually works.</p>
<p>Create <code>hello.bat</code> with the following contents and place it in <code>j:\include\psTools\scripts</code>:</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%computername%</span> says: <span class="s2">&#34;hello world&#34;</span> <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log</span></span></code></pre></div></div>
<p>Go sit down at your local managing machine, open up a command line window and type in the following:</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">j<span class="p">:</span><span class="nl">\include\psTools\distros\manage_farm.bat</span><span class="c1"> hello.bat</span></span></span></code></pre></div></div>
<p>Now the scripts are crunching and you should be able to see how PsExec is connecting to each machine and starts a process.</p>
<p>If everything worked so far, you should also find log files in <code>j:\include\psTools\logs\</code> where you can see which machines reported back the &ldquo;hello world&rdquo; message.</p>
<p>Once again, let us have a look at the diagram, where we are now full circle!</p>
<p><img src="/blog/assets/pstools/ps4_pstools_illustration_step3.png" alt=""></p>
<p>The <code>hello.bat</code> is being launched on all remote machines defined in manage_farm.bat and log files are being created on the server’s <code>\include\psTools\logs</code> folder.</p>
<h2 id="step-4-solving-problems">Step 4: Solving problems</h2>
<p>You will most likely stumble upon issues when setting all of this up. Check out 



<a href="../2011-05-13-remote-windows-management-with-pstools-part-1/">part 1</a> of this article series to troubleshoot PsTools itself if you cannot get PsExec to connect to a remote machine.</p>
<p>If, for some reason, you have issues with launching a certain task, you can remove the flag <code>-d</code> from any PsExec-related line in <code>manage_farm.bat</code> and it will not release the process but instead hold it until completed and show you what is spewed out on the command line. That same data is also written to the <code>manage_farm.bat</code> log file.</p>
<h2 id="a-collection-of-task-scripts">A collection of task scripts</h2>
<p>Here is a collection of scripts that I have created for distribution on our render farm. As you may notice, I have included a bit of error handling. And again, use these scripts with caution. I take no responsibility!</p>
<p>Replace <code>j:\assets\software\</code> with whatever path you need…</p>
<h3 id="nuke-62v4">Nuke 6.2v4</h3>
<p>This is a silent installation and will not show up on the remote machine’s desktop.</p>
<p>Just replace the path and executable name for any other Nuke version. I have asked The Foundry to make it possible to opt out for the desktop icons which are created after install, but it does not seem like they have implemented anything like that as of writing this.</p>
<p>The code of <code>nuke6.2v4_x64_silent_install.bat</code> below:</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Installing Nuke 6.2v4... <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="s2">&#34;j:\assets\software\nuke\Nuke6.2v4\Nuke6.2v4-win-x86-release-64.exe&#34;</span> /verysilent
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="nv">%errorlevel%</span><span class="o">==</span>0 <span class="k">goto</span> <span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Installation completed without errors <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="k">exit</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: ERROR ENCOUNTERED <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="k">exit</span> /B -1</span></span></code></pre></div></div>
<h3 id="setting-an-environment-variable">Setting an environment variable</h3>
<p>This just simply sets the environment variable <code>NUKE_PATH</code>. Necessary if you create your own menus and stuff&hellip;</p>
<p>The code of <code>set_nuke_variable.bat</code> below:</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Setting environment variable NUKE_PATH... <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl">setx NUKE_PATH <span class="s2">&#34;j:/include/nuke&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="nv">%errorlevel%</span><span class="o">==</span>0 <span class="k">goto</span> <span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Environment variable NUKE_PATH set without errors <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="k">exit</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: ERROR ENCOUNTERED <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="k">exit</span> /B -1</span></span></code></pre></div></div>
<h3 id="python-31">Python 3.1</h3>
<p>This is an old script but I guess it should work for newer versions of Python as well.</p>
<p>The code of <code>python_3.1.2_install.bat</code> below:</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Installing Python 3.1.2... <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl">msiexec /package <span class="s2">&#34;j:\assets\software\python\python-3.1.2.amd64.msi&#34;</span> ALLUSERS=1 /quiet
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Registering Python path with environment variable PATH� <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl">setx path <span class="s2">&#34;</span><span class="nv">%path%</span><span class="s2">;C:\Python31&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="nv">%errorlevel%</span><span class="o">==</span>0 <span class="k">goto</span> <span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Python path added to environment variable PATH and Python 3.1.2 installed without errors <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="k">exit</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: ERROR ENCOUNTERED <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="k">exit</span> /B -1</span></span></code></pre></div></div>
<h3 id="maya-2012">Maya 2012</h3>
<p>Launch Maya 2012 setup and create a deployment package. Then place this somewhere on your server. This installation will be visible as a loading bar on the remote machine’s desktop.</p>
<p>The code of <code>maya2012-x64_deploy_install.bat</code> below:</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Installing Maya 2012 deployment package... <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl">explorer j:\assets\software\maya\2012\Deployment\maya2012-x64\Maya2012-x64.lnk
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="nv">%errorlevel%</span><span class="o">==</span>0 <span class="k">goto</span> <span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Maya 2012 installed without errors <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="k">exit</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: ERROR ENCOUNTERED <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="k">exit</span> /B -1</span></span></code></pre></div></div>
<h3 id="v-ray-150-nightly-build-for-maya-2011">V-Ray 1.50 nightly build for Maya 2011</h3>
<p>This is a silent installation and will not show up on the remote machine’s desktop. Please note that if there is a previous build of V-Ray for Maya installed, it will be automatically removed before the new files are copied.</p>
<p>You will need to create an XML to control the installation. I am calling this file <code>VrayForMaya2012_install.xml</code>:</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;Value</span> <span class="na">Name=</span><span class="s">&#34;MAYAROOT&#34;</span> <span class="na">DataType=</span><span class="s">&#34;value&#34;</span><span class="nt">&gt;</span>C:\Program Files\Autodesk\Maya2011\<span class="nt">&lt;/Value&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;Value</span> <span class="na">Name=</span><span class="s">&#34;STDROOT&#34;</span> <span class="na">DataType=</span><span class="s">&#34;value&#34;</span><span class="nt">&gt;</span>C:\Program Files\Chaos Group\V-Ray\Maya 2011 for x64<span class="nt">&lt;/Value&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;Value</span> <span class="na">Name=</span><span class="s">&#34;MODULEDEST&#34;</span> <span class="na">DataType=</span><span class="s">&#34;value&#34;</span><span class="nt">&gt;</span>C:\Program Files\Autodesk\Maya2011/modules<span class="nt">&lt;/Value&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;Value</span> <span class="na">Name=</span><span class="s">&#34;PLUGINS&#34;</span> <span class="na">DataType=</span><span class="s">&#34;value&#34;</span><span class="nt">&gt;</span>C:\Program Files\Autodesk\Maya2011/vray<span class="nt">&lt;/Value&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;Value</span> <span class="na">Name=</span><span class="s">&#34;OPEN_CHANGELOG&#34;</span> <span class="na">DataType=</span><span class="s">&#34;value&#34;</span><span class="nt">&gt;</span>0<span class="nt">&lt;/Value&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;Value</span> <span class="na">Name=</span><span class="s">&#34;REGISTER_RENERSLAVE_SERVICE&#34;</span> <span class="na">DataType=</span><span class="s">&#34;value&#34;</span><span class="nt">&gt;</span>0<span class="nt">&lt;/Value&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/DefValues&gt;</span></span></span></code></pre></div></div>
<p>Here is an explanation of the alterable values:</p>
<p><code>MAYAROOT</code> - this is the root Maya folder.
<code>STDROOT</code> - this is the folder where various other files will be installed (documentation, SDK etc).
<code>MODULEDEST</code> - the Maya modules folder.
<code>PLUGINS</code> - this is the folder where V-Ray specific Maya-related stuff will be installed (scripts, plugins etc).
<code>OPEN_CHANGELOG</code> - this is 1 to open the changelog after the installation and 0 if you don’t want it to open.
<code>INSTALL_TYPE</code> - 0 is full install (workstation, includes SDK). 1 is standalone only.
<code>REGISTER_RENERSLAVE_SERVICE</code> - Despite of the typo, this works. 1 registers the render slave service. 0 does not register the render slave service.</p>
<p>Place the XML file inside the <code>j:\include\psTools\scripts</code> folder. Then create the task script to distribute:</p>
<p>The code of <code>vray150sp1-build_14204_for_maya2011-x64_silent_install.bat</code>:</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Setting the license XML env variable... <span class="p">&gt;</span>&gt;
</span></span><span class="line"><span class="cl">setx VRAY_AUTH_CLIENT_FILE_PATH <span class="s2">&#34;j:/include/vray/license&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: Installing V-Ray 1.50SP1 nightly build 14204... <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="s2">&#34;j:\assets\software\VrayForMaya\NightlyBuilds\110302_v14204\vray_adv_150SP1_maya2011_x64_14204\vray_adv_150SP1_maya2011_x64.exe&#34;</span> -gui=0 -configFile=<span class="s2">&#34;j:\include\psTools\scripts\VrayForMaya2012_install.xml&#34;</span> -quiet=1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="nv">%errorlevel%</span><span class="o">==</span>0 <span class="k">goto</span> <span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: V-Ray 1.50SP1 nightly build 14204 installed without errors <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="k">exit</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> <span class="nv">%date%</span> - <span class="nv">%time%</span>: ERROR ENCOUNTERED <span class="p">&gt;&gt;</span> j:\include\psTools\logs\<span class="nv">%computername%</span>.log
</span></span><span class="line"><span class="cl"><span class="k">exit</span> /B -1</span></span></code></pre></div></div>
<p>Note that in order to specify the license server, you will need to create the environment variable <code>VRAY_AUTH_CLIENT_FILE_PATH</code> and point this to a location where the V-Ray will look for a file called <code>vrlclient.xml</code>. In the sample above, I am setting this to <code>j:/include/vray/license</code>.</p>
<p>The syntax of <code>vrlclient.xml</code> is as follows (change IP addresses to make this fit into your setup):</p>
<div class="code-block-wrapper">
  <button class="copy-code-button" aria-label="Copy code to clipboard">
    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
      <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
    </svg>
    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
  </button><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;VRLClient&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;LicServer&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Host&gt;</span>10.0.1.100<span class="nt">&lt;/Host&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Port&gt;</span>30304<span class="nt">&lt;/Port&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Host1&gt;&lt;/Host1&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Port1&gt;</span>30304<span class="nt">&lt;/Port1&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Host2&gt;&lt;/Host2&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Port2&gt;</span>30304<span class="nt">&lt;/Port2&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cp">&lt;!Proxy&gt;</span><span class="err">&lt;</span>/!Proxy&gt;
</span></span><span class="line"><span class="cl">    <span class="cp">&lt;!ProxyPort&gt;</span>0<span class="err">&lt;</span>/!ProxyPort&gt;
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;User&gt;&lt;/User&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Pass&gt;&lt;/Pass&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/LicServer&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/VRLClient&gt;</span></span></span></code></pre></div></div>
<p>Keep reading 



<a href="../2011-06-02-remote-windows-management-with-pstools-part-3/">part 3</a> for more info on how to control remote V-Ray slaves using PsTools.</p>

</main>


<div id="giscus-container" class="giscus-comments">
  <div class="load-comments-wrapper">
    <button id="load-comments-btn" class="load-comments-btn">Load Comments</button>
  </div>
</div>

<script>
  (function() {
    const container = document.getElementById('giscus-container');
    const loadBtn = document.getElementById('load-comments-btn');

    
    function loadGiscus() {
      if (!container) return;
      
      
      container.innerHTML = ''; 

      const theme = document.body.classList.contains('dark') ? 'dark' : 'light';
      
      const giscusScript = document.createElement('script');
      giscusScript.src = 'https://giscus.app/client.js';
      giscusScript.setAttribute('data-repo', 'fredrikaverpil/fredrikaverpil.github.io');
      giscusScript.setAttribute('data-repo-id', 'MDEwOlJlcG9zaXRvcnkxMzEwNDU4Njc=');
      giscusScript.setAttribute('data-category', 'General');
      giscusScript.setAttribute('data-category-id', 'DIC_kwDOB8-Z684CU9zc');
      giscusScript.setAttribute('data-mapping', 'title');
      giscusScript.setAttribute('data-strict', '0');
      giscusScript.setAttribute('data-reactions-enabled', '1');
      giscusScript.setAttribute('data-emit-metadata', '0');
      giscusScript.setAttribute('data-input-position', 'bottom');
      giscusScript.setAttribute('data-theme', theme);
      giscusScript.setAttribute('data-lang', 'en');
      giscusScript.setAttribute('crossorigin', 'anonymous');
      giscusScript.async = true;

      container.appendChild(giscusScript);
    }

    
    if (loadBtn) {
      loadBtn.addEventListener('click', loadGiscus);
    }

    
    function setGiscusTheme(theme) {
      const giscusFrame = document.querySelector('iframe.giscus-frame');
      if (giscusFrame && giscusFrame.contentWindow) {
        giscusFrame.contentWindow.postMessage(
          { giscus: { setConfig: { theme } } },
          'https://giscus.app'
        );
      }
    }

    
    const themeToggle = document.getElementById('theme-toggle');
    if (themeToggle) {
      themeToggle.addEventListener('click', () => {
        
        setTimeout(() => {
          const currentTheme = document.body.classList.contains('dark') ? 'dark' : 'light';
          setGiscusTheme(currentTheme);
        }, 10); 
      });
    }

    
    if (window.matchMedia) {
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
        if (!localStorage.getItem('theme')) { 
          const newTheme = event.matches ? "dark" : "light";
          setGiscusTheme(newTheme);
        }
      });
    }
  })();
</script>



<footer>
	<div class="footer-content">
		<span class="footer-icons">
			
			
			<a href="https://github.com/fredrikaverpil" target="_blank" rel="noopener" title="GitHub">
				

<svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" fill="currentColor"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>

			</a>
			
			
			<a href="https://fosstodon.org/@fredrikaverpil" target="_blank" rel="noopener" title="Mastodon">
				

<svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" fill="currentColor"><path d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23 0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112 0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311 0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13 0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z"/></svg>

			</a>
			
			
			<a href="https://bsky.app/profile/fredrikaverpil.bsky.social" target="_blank" rel="noopener" title="Bluesky">
				

<svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" fill="currentColor"><path d="M5.202 2.857C7.954 4.922 10.913 9.11 12 11.358c1.087-2.247 4.046-6.436 6.798-8.501C20.783 1.366 24 .213 24 3.883c0 .732-.42 6.156-.667 7.037-.856 3.061-3.978 3.842-6.755 3.37 4.854.826 6.089 3.562 3.422 6.299-5.065 5.196-7.28-1.304-7.847-2.97-.104-.305-.152-.448-.153-.327 0-.121-.05.022-.153.327-.568 1.666-2.782 8.166-7.847 2.97-2.667-2.737-1.432-5.473 3.422-6.3-2.777.473-5.899-.308-6.755-3.369C.42 10.04 0 4.615 0 3.883c0-3.67 3.217-2.517 5.202-1.026"/></svg>

			</a>
			
			
			<a href="https://linkedin.com/in/fredrik" target="_blank" rel="noopener" title="LinkedIn">
				

<svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>

			</a>
			
			
			<a href="/blog/index.xml" target="_blank" rel="noopener" title="RSS">
				

<svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" fill="currentColor"><path d="M19.199 24C19.199 13.467 10.533 4.8 0 4.8V0c13.165 0 24 10.835 24 24h-4.801zM3.291 17.415c1.814 0 3.293 1.479 3.293 3.295 0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526 0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727 0 15.909 7.184 15.909 15.91z"/></svg>

			</a>
			
			
			<a href="https://cloud.umami.is/share/tJcIgDO3dznRmeGX" target="_blank" rel="noopener" title="Umami">
				

<svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" fill="currentColor"><path d="M2.203 8.611H.857a.845.845 0 0 0-.841.841v.858a13.31 13.31 0 0 0-.016.6c0 6.627 5.373 12 12 12 6.527 0 11.837-5.212 11.996-11.701 0-.025.004-.05.004-.075V9.452a.845.845 0 0 0-.841-.841h-1.346c-1.159-4.329-5.112-7.521-9.805-7.521-4.692 0-8.645 3.192-9.805 7.521Zm18.444 0H3.37c1.127-3.702 4.57-6.399 8.638-6.399 4.069 0 7.512 2.697 8.639 6.399Z"/></svg>

			</a>
			
		</span>
		<span class="footer-text">
			© Mark Holloway 2005-2026
		</span>
	</div>
	<script src="/js/main.js"></script>

</footer>
</body>

</html>

